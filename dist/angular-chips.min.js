!function(){function e(e){return e&&angular.isFunction(e.then)}function n(e){return{add:function(n){var i=angular.copy(e.$modelValue)||[];i.push(n),e.$setViewValue(i)},"delete":function(n){var i=angular.copy(e.$modelValue);i.splice(n,1),e.$setViewValue(i)},deleteByValue:function(n){var i,t;for(i=0;i<e.$modelValue.length;i++)if(angular.equals(e.$modelValue[i],n)){t=i;break}void 0!==t&&this["delete"](t)}}}function i(e,n){var i=this;this.type="defer",this.defer=e,this.isLoading=!1,this.isFailed=!1,n&&(i.isLoading=!0,n.then(function(e){i.defer=e,i.isLoading=!1},function(e){i.defer=e,i.isLoading=!1,i.isFailed=!0}))}function t(e){if(void 0!==e){var n,i;return n=e.indexOf("(")+1,i=e.indexOf(")"),e.substr(n,i-n)}}function r(r,o,c){function a(o,a,u,s,d){if(!o.chipTemplate)throw"should have chip-tmpl";var p,h=n(s),f=u.hasOwnProperty("defer"),v=t(u.render),g=a.find("input")[0];o.chips.addChip=function(n){function t(e){o.chips.list.push(e),h.add(e)}var r,l;void 0!==o.render&&""!==v?(l={},l[v]=n,r=o.render(l)):r=n,e(r)?(r.then(function(e){h.add(e)}),o.chips.list.push(new i(n,r)),o.$apply()):t(r),o.onAdd&&o.onAdd({$chip:n})},o.chips.deleteChip=function(e){if(!(e<0||e>=o.chips.list.length)){var n=o.chips.list[e];if(!o.removeChip||o.removeChip({$chip:n}))return o.chips.list.splice(e,1),n.isFailed?void o.$apply():(n instanceof i?h.deleteByValue(n.defer):h["delete"](e),o.onRemove&&o.onRemove({$chip:n}),!0)}},s.$render=function(){if(f&&s.$modelValue){var e,n=[];for(e=0;e<s.$modelValue.length;e++)n.push(new i(s.$modelValue[e]));o.chips.list=n}else o.chips.list=angular.copy(s.$modelValue)||[]},p=angular.element("<div></div>");var m=angular.element(o.chipTemplate);m.attr("ng-repeat","chip in chips.list track by $index"),m.attr("ng-class","{'chip-failed':chip.isFailed}"),m.attr("tabindex","-1"),m.attr("index","{{$index}}"),p.append(m);var C=r(p)(o);a.prepend(C),a.on("click",function(e){"CHIPS"===e.target.nodeName&&g.focus()}),o.chips.handleKeyDown=function(e){function n(n){var t,r=parseInt(e.target.getAttribute("index"));t=r>=0?r:i.length;var l=t+n;l<0?0===o.chips.list.length&&g.focus():l>=i.length?g.focus():i[l].focus()}if(!(e.target===g&&g.value.length>0)){var i=p.children();if(e.keyCode===l.BACKSPACE){var t=parseInt(e.target.getAttribute("index"));e.target===g&&""===e.target.value?n(-1):e.target.parentElement===p[0]&&o.chips.deleteChip(t)&&n(-1),e.preventDefault()}else e.keyCode===l.LEFT?n(-1):e.keyCode===l.RIGHT&&n(1)}},a.on("keydown",o.chips.handleKeyDown),c(a).addClass("chip-out-focus")}return a.$inject=["scope","iElement","iAttrs","ngModelCtrl","transcludefn"],{restrict:"E",scope:{render:"&?",removeChip:"&?",onAdd:"&?",onRemove:"&?"},transclude:!0,require:"ngModel",link:a,controller:"chipsController",controllerAs:"chips",template:"<div ng-transclude></div>"}}function o(e,n,i){this.registerChild=function(n){if(e.chipTemplate)throw"should have only one chip-tmpl";e.chipTemplate=n},this.setFocus=function(e){e?i(n).removeClass("chip-out-focus").addClass("chip-in-focus"):i(n).removeClass("chip-in-focus").addClass("chip-out-focus")},this.removeChip=function(n,i){e.chips.deleteChip(i)}}r.$inject=["$compile","$timeout","DomUtil"],o.$inject=["$scope","$element","DomUtil"],angular.module("angular.chips",[]).directive("chips",r).controller("chipsController",o);var l={BACKSPACE:8,LEFT:37,RIGHT:39}}(),function(){function e(){return{require:"^^chips",transclude:!0,link:function(e,n,i,t,r){r(e,function(e){var i="";angular.forEach(e,function(e){i+=e.outerHTML||""}),t.registerChild(i),n.remove()})}}}angular.module("angular.chips").directive("chipTmpl",e)}(),function(){function e(){return{restrict:"A",require:"^?chips",link:function(e,n,i,t){function r(){"string"!=typeof e.chip&&e.chip.isLoading||t.removeChip(e.chip,e.$index)}n.on("click",function(){r()})}}}angular.module("angular.chips").directive("removeChipButton",e)}(),function(){function e(e){var n={};return n.addClass=function(i){return n.removeClass(e,i),e.attr("class",e.attr("class")+" "+i),n},n.removeClass=function(i){var t=e.attr("class").split(" "),r=t.indexOf(i);return r!==-1&&t.splice(r,1),e.attr("class",t.join(" ")),n},n}angular.module("angular.chips").factory("DomUtil",function(){return e})}(),function(){function e(){return{restrict:"A",require:"^chips",link:n}}function n(e,n,i,t){n.on("keypress",function(e){13===e.keyCode&&""!==e.target.value&&(t.addChip(e.target.value),e.target.value="",e.preventDefault())}),n.on("focus",function(){t.setFocus(!0)}),n.on("blur",function(){t.setFocus(!1)})}n.$inject=["scope","iElement","iAttrs","chipsCtrl"],angular.module("angular.chips").directive("chipControl",e)}(),function(){function e(){return{restrict:"A",require:["ngModel","^chips"],link:function(e,n,i,t){var r=t[0],o=t[1];r.$render=function(e){r.$modelValue&&(o.addChip(r.$modelValue),n.val(""))},n.on("focus",function(){o.setFocus(!0)}),n.on("blur",function(){o.setFocus(!1)})}}}angular.module("angular.chips").directive("ngModelControl",e)}();